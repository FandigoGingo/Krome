(()=>{const e=document.getElementById("commentform"),t=document.getElementById("capError");async function n(){t.classList.add("hideElement");const e=await(await fetch("/wp-admin/admin-ajax.php?action=gox_create_captcha")).json(),{image:n,token:a}=e.data.Client.captcha,c=document.getElementById("capImg");c&&(c.src=n);const d=document.getElementById("capCode");d&&(d.value="");const o=document.getElementById("capToken");o&&(o.value=a),document.getElementById("capOverlay")?.classList.add("showElement"),document.getElementById("capModal")?.classList.add("showModal")}function a(){const e=document.getElementById("capCode");e&&(e.value=""),document.getElementById("capOverlay")?.classList.remove("showElement"),document.getElementById("capModal")?.classList.remove("showModal")}if(document.getElementById("capOverlay")?.addEventListener("click",a),e){e.noValidate=!0,e.addEventListener("keyup",(e=>"Escape"===e.key&&a())),e.addEventListener("submit",(c=>{if(e.checkValidity())if(e.classList.remove("form-submit-fail"),document.getElementById("capCode")?.value&&document.getElementById("capToken")?.value){const n=[].filter.call(e,(e=>!!e.name)).map((e=>`${encodeURIComponent(e.name).replace("%20","+")}=${encodeURIComponent(e.value).replace("%20","+")}`)).join("&");(async()=>{try{const c=await fetch(e.action,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded;charset=UTF-8"},credentials:"include",body:n});if(c.ok)e.action!==c.url?window.location.href=c.url:(a(),e.classList.add("form-submit-fail"));else{if(403===c.status)return void t.classList.remove("hideElement");a(),e.classList.add("form-submit-fail")}}catch(t){e.classList.add("form-submit-fail")}})()}else{if("capSendBtn"===c.submitter.id)return t.classList.remove("hideElement"),void c.preventDefault();n()}else e.classList.add("form-submit-fail");document.getElementById("capCode")?.value||a(),c.preventDefault()}));const c=document.getElementById("capRefreshBtn");c&&c.addEventListener("click",(()=>{n()}))}document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("second_name");e&&e.removeAttribute("required");const t=document.getElementById("cancel-comment-reply-link")?.parentNode;if(t){const e=document.getElementById("submit");e?.parentNode?.insertBefore(t,e)}}))})();